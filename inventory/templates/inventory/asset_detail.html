{% extends 'inventory/base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Asset Details" %}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    .card {
        border: none;
        box-shadow: 0 0.125rem 0.25rem rgba(0,0,0,0.075);
        margin-bottom: 1.5rem;
        border-radius: 0.5rem;
    }
    .card-header {
        background-color: #2c3e50;
        color: white;
        border-bottom: none;
        padding: 1rem;
        border-radius: 0.5rem 0.5rem 0 0;
    }
    .card-header h5 { margin: 0; font-weight: 500; }
    .card-body { 
        background-color: #f8f9fa;
        padding: 1.5rem;
    }
    .section-title { color: #2c3e50; font-weight: 600; margin-bottom: 1rem; }
    .info-label { font-weight: 500; color: #34495e; }
    .info-value { color: #2c3e50; }
    .icon { width: 1.5em; text-align: center; }
    .btn-action { 
        margin-right: 0.5rem;
        border-radius: 0.25rem;
        padding: 0.5rem 1rem;
    }
    .status-badge {
        padding: 0.5rem 1rem;
        border-radius: 0.25rem;
        font-weight: 500;
    }
    .status-available { background-color: #28a745; color: white; }
    .status-assigned { background-color: #17a2b8; color: white; }
    .status-maintenance { background-color: #ffc107; color: black; }
    .status-retired { background-color: #dc3545; color: white; }
    .action-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-top: 1rem;
    }
    .action-buttons .btn {
        flex: 1;
        min-width: 200px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .action-buttons .btn i {
        margin-right: 0.5rem;
    }
    .warranty-warning {
        background-color: #fff3cd;
        border: 1px solid #ffeeba;
        color: #856404;
        padding: 0.75rem;
        border-radius: 0.25rem;
        margin-bottom: 1rem;
    }
    .warranty-expired {
        background-color: #f8d7da;
        border: 1px solid #f5c6cb;
        color: #721c24;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12 d-flex justify-content-between align-items-center mt-4 mb-3">
            <h1 class="h2">
                <i class="fas fa-desktop me-2"></i>{% trans "Asset Details" %}
                <small class="text-muted">#{{ object.id }}</small>
            </h1>
            <div>
                <a href="{% url 'inventory:asset_list' %}" class="btn btn-secondary">
                    <i class="fas fa-arrow-left me-2"></i>{% trans "Back to List" %}
                </a>
            </div>
        </div>

        <!-- Status Banner -->
        {% if object.warranty_expiry %}
            {% with days_until_expiry=object.warranty_expiry|timeuntil %}
                {% if days_until_expiry|stringformat:"s"|slice:":2"|add:"0" <= 30 %}
                    <div class="col-12">
                        <div class="warranty-warning {% if days_until_expiry|stringformat:"s"|slice:":2"|add:"0" <= 0 %}warranty-expired{% endif %}">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            {% if days_until_expiry|stringformat:"s"|slice:":2"|add:"0" <= 0 %}
                                {% trans "Warranty has expired!" %}
                            {% else %}
                                {% trans "Warranty expires in" %} {{ days_until_expiry }}
                            {% endif %}
                        </div>
                    </div>
                {% endif %}
            {% endwith %}
        {% endif %}

        <div class="col-12 col-lg-10 mx-auto">
            <!-- Basic Information -->
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5><i class="fas fa-info-circle icon"></i> {% trans "Basic Information" %}</h5>
                    <span class="status-badge status-{{ object.status }}">
                        {{ object.get_status_display }}
                    </span>
                </div>
                <div class="card-body row">
                    <div class="col-md-6 mb-3">
                        <div class="info-label">{% trans "Asset Name" %}</div>
                        <div class="info-value">{{ object.name }}</div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="info-label">{% trans "Asset Type" %}</div>
                        <div class="info-value">{{ object.asset_type.display_name }}</div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="info-label">{% trans "Serial Number" %}</div>
                        <div class="info-value">{{ object.serial_number }}</div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="info-label">{% trans "Model" %}</div>
                        <div class="info-value">{{ object.model }}</div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="info-label">{% trans "Manufacturer" %}</div>
                        <div class="info-value">{{ object.manufacturer }}</div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="info-label">{% trans "Owner" %}</div>
                        <div class="info-value">{{ object.owner.name }}</div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="card">
                <div class="card-header">
                    <h5><i class="fas fa-tools icon"></i> {% trans "Actions" %}</h5>
                </div>
                <div class="card-body">
                    <div class="action-buttons">
                        {% if perms.inventory.change_itasset %}
                        <a href="{% url 'inventory:asset_update' object.pk %}" class="btn btn-primary">
                            <i class="fas fa-edit"></i>{% trans "Edit Asset" %}
                        </a>
                        {% endif %}
                        
                        {% if perms.inventory.delete_itasset %}
                        <a href="{% url 'inventory:asset_delete' object.pk %}" class="btn btn-danger">
                            <i class="fas fa-trash"></i>{% trans "Delete Asset" %}
                        </a>
                        {% endif %}
                        
                        <a href="{% url 'inventory:create_maintenance_request' object.pk %}" class="btn btn-warning">
                            <i class="fas fa-tools"></i>{% trans "Request Maintenance" %}
                        </a>
                        
                        <a href="{% url 'inventory:report_damaged_device' object.pk %}" class="btn btn-danger">
                            <i class="fas fa-exclamation-triangle"></i>{% trans "Report Damage" %}
                        </a>
                        
                        <a href="{% url 'inventory:report_lost_device' object.pk %}" class="btn btn-danger">
                            <i class="fas fa-search"></i>{% trans "Report Lost" %}
                        </a>
                    </div>
                </div>
            </div>

            <!-- Computer Specifications -->
            {% if object.asset_type.name == 'laptop' or object.asset_type.name == 'desktop' %}
            <div class="card">
                <div class="card-header"><h5><i class="fas fa-laptop icon"></i> Computer Specifications</h5></div>
                <div class="card-body row">
                    <div class="col-md-6 mb-2"><span class="info-label">Processor:</span> <span class="info-value">{{ object.processor }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">RAM Size:</span> <span class="info-value">{{ object.ram_size }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Primary Storage:</span> <span class="info-value">{{ object.hdd1_capacity }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Secondary Storage:</span> <span class="info-value">{{ object.hdd2_capacity }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Operating System:</span> <span class="info-value">{{ object.operating_system }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">OS Version:</span> <span class="info-value">{{ object.os_version }}</span></div>
                </div>
            </div>
            {% endif %}

            <!-- Monitor Specifications -->
            {% if object.asset_type.name == 'monitor' %}
            <div class="card">
                <div class="card-header"><h5><i class="fas fa-desktop icon"></i> Monitor Specifications</h5></div>
                <div class="card-body row">
                    <div class="col-md-6 mb-2"><span class="info-label">Monitor Type:</span> <span class="info-value">{{ object.get_monitor_type_display }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Panel Type:</span> <span class="info-value">{{ object.get_panel_type_display }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Screen Size:</span> <span class="info-value">{{ object.screen_size }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Resolution:</span> <span class="info-value">{{ object.resolution }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">VESA Mount:</span> <span class="info-value">{{ object.vesa_mount|yesno:'Yes,No' }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Built-in Speakers:</span> <span class="info-value">{{ object.built_in_speakers|yesno:'Yes,No' }}</span></div>
                </div>
            </div>
            {% endif %}

            <!-- Printer Specifications -->
            {% if object.asset_type.name == 'printer' %}
            <div class="card">
                <div class="card-header"><h5><i class="fas fa-print icon"></i> Printer Specifications</h5></div>
                <div class="card-body row">
                    <div class="col-md-6 mb-2"><span class="info-label">Printer Type:</span> <span class="info-value">{{ object.get_printer_type_display }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Connection Type:</span> <span class="info-value">{{ object.get_connection_type_display }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Department:</span> <span class="info-value">{{ object.printer_department }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Responsible Person:</span> <span class="info-value">{{ object.printer_responsible }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Last Maintenance Date:</span> <span class="info-value">{{ object.last_maintenance_date }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Toner Cartridge Model:</span> <span class="info-value">{{ object.toner_cartridge_model }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Paper Size Support:</span> <span class="info-value">{{ object.paper_size_support }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Duplex Printing:</span> <span class="info-value">{{ object.duplex_printing|yesno:'Yes,No' }}</span></div>
                </div>
            </div>
            {% endif %}

            <!-- UPS Specifications -->
            {% if object.asset_type.name == 'ups' %}
            <div class="card">
                <div class="card-header"><h5><i class="fas fa-bolt icon"></i> UPS Specifications</h5></div>
                <div class="card-body row">
                    <div class="col-md-6 mb-2"><span class="info-label">Capacity (VA):</span> <span class="info-value">{{ object.ups_capacity }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Number of Batteries:</span> <span class="info-value">{{ object.ups_battery_count }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Remaining Battery Life (months):</span> <span class="info-value">{{ object.ups_battery_life }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Battery Replacement Date:</span> <span class="info-value">{{ object.ups_battery_replacement_date }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">UPS Manufacturer:</span> <span class="info-value">{{ object.ups_manufacturer }}</span></div>
                </div>
            </div>
            {% endif %}

            <!-- Switch Specifications -->
            {% if object.asset_type.name == 'switch' %}
            <div class="card">
                <div class="card-header"><h5><i class="fas fa-network-wired icon"></i> Switch Specifications</h5></div>
                <div class="card-body row">
                    <div class="col-md-6 mb-2"><span class="info-label">Switch Type:</span> <span class="info-value">{{ object.switch_type }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Port Count:</span> <span class="info-value">{{ object.port_count }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Port Speed:</span> <span class="info-value">{{ object.port_speed }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Management Type:</span> <span class="info-value">{{ object.management_type }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">PoE Support:</span> <span class="info-value">{{ object.poe_support|yesno:'Yes,No' }}</span></div>
                </div>
            </div>
            {% endif %}

            <!-- Network Information -->
            <div class="card">
                <div class="card-header"><h5><i class="fas fa-network-wired icon"></i> Network Information</h5></div>
                <div class="card-body row">
                    <div class="col-md-4 mb-2"><span class="info-label">Wi-Fi MAC Address:</span> <span class="info-value">{{ object.mac_address_wifi }}</span></div>
                    <div class="col-md-4 mb-2"><span class="info-label">Ethernet MAC Address:</span> <span class="info-value">{{ object.mac_address_ethernet }}</span></div>
                    <div class="col-md-4 mb-2"><span class="info-label">IP Address:</span> <span class="info-value">{{ object.ip_address }}</span></div>
                </div>
            </div>

            <!-- Assignment Information -->
            <div class="card">
                <div class="card-header"><h5><i class="fas fa-user-check icon"></i> Assignment Information</h5></div>
                <div class="card-body row">
                    <div class="col-md-6 mb-2"><span class="info-label">Delivery Letter Code:</span> <span class="info-value">{{ object.delivery_letter_code }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Status:</span> <span class="info-value">{{ object.get_status_display }}</span></div>
                    <div class="col-md-6 mb-2"><span class="info-label">Assigned To:</span> <span class="info-value">{{ object.assigned_to }}</span></div>
                </div>
            </div>

            <!-- Dates Information -->
            <div class="card">
                <div class="card-header"><h5><i class="fas fa-calendar-alt icon"></i> Dates Information</h5></div>
                <div class="card-body row">
                    <div class="col-md-4 mb-2"><span class="info-label">Purchase Date:</span> <span class="info-value">{{ object.purchase_date }}</span></div>
                    <div class="col-md-4 mb-2"><span class="info-label">Receipt Date:</span> <span class="info-value">{{ object.receipt_date }}</span></div>
                    <div class="col-md-4 mb-2"><span class="info-label">Warranty Expiry:</span> <span class="info-value">{{ object.warranty_expiry }}</span></div>
                </div>
            </div>

            <!-- Notes -->
            {% if object.notes %}
            <div class="card">
                <div class="card-header"><h5><i class="fas fa-sticky-note icon"></i> Additional Information</h5></div>
                <div class="card-body">
                    <span class="info-value">{{ object.notes|linebreaksbr }}</span>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %} 